<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Perfornium Dashboard</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 128 128'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%2300d4ff'/%3E%3Cstop offset='100%25' stop-color='%239c40ff'/%3E%3C/linearGradient%3E%3ClinearGradient id='grad2' x1='0%25' y1='100%25' x2='100%25' y2='0%25'%3E%3Cstop offset='0%25' stop-color='%2300d4ff'/%3E%3Cstop offset='100%25' stop-color='%239c40ff'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect x='4' y='4' width='120' height='120' rx='24' fill='%230f0f23'/%3E%3Crect x='32' y='28' width='12' height='72' rx='6' fill='url(%23grad)'/%3E%3Cpath d='M 38 28 L 62 28 C 88 28 88 60 62 60 L 38 60' fill='none' stroke='url(%23grad)' stroke-width='12' stroke-linecap='round' stroke-linejoin='round'/%3E%3Crect x='76' y='68' width='8' height='32' rx='4' fill='url(%23grad2)' opacity='0.9'/%3E%3Crect x='88' y='54' width='8' height='46' rx='4' fill='url(%23grad)' opacity='0.9'/%3E%3C/svg%3E">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <div class="header">
    <div class="logo">
      <svg viewBox="0 0 128 128"><defs><linearGradient id="lg1" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#00d4ff"/><stop offset="100%" stop-color="#9c40ff"/></linearGradient><linearGradient id="lg2" x1="0%" y1="100%" x2="100%" y2="0%"><stop offset="0%" stop-color="#00d4ff"/><stop offset="100%" stop-color="#9c40ff"/></linearGradient></defs><rect x="4" y="4" width="120" height="120" rx="24" fill="#0f0f23"/><rect x="32" y="28" width="12" height="72" rx="6" fill="url(#lg1)"/><path d="M 38 28 L 62 28 C 88 28 88 60 62 60 L 38 60" fill="none" stroke="url(#lg1)" stroke-width="12" stroke-linecap="round" stroke-linejoin="round"/><rect x="76" y="68" width="8" height="32" rx="4" fill="url(#lg2)" opacity="0.9"/><rect x="88" y="54" width="8" height="46" rx="4" fill="url(#lg1)" opacity="0.9"/></svg>
      Perfornium Dashboard
    </div>
    <div style="display: flex; align-items: center; gap: 16px;">
      <div id="workersStatus"></div>
      <div id="connectionStatus"></div>
    </div>
  </div>

  <div class="container">
    <div class="tabs">
      <div class="tab active" data-tab="tests">Tests</div>
      <div class="tab" data-tab="live">Live</div>
      <div class="tab" data-tab="infra">Infra</div>
      <div class="tab" data-tab="results">Results</div>
      <div class="tab" data-tab="compare">Compare</div>
    </div>

    <!-- Tests Panel -->
    <div id="tests" class="panel active">
      <div class="grid-3">
        <div class="card">
          <div class="card-header">
            <h3>Available Tests</h3>
            <button class="btn btn-secondary btn-sm" onclick="loadTests()">Refresh</button>
          </div>
          <div class="test-list" id="testsList"></div>
        </div>
        <div class="card">
          <h3>Load Override</h3>
          <p style="color: var(--text-secondary); font-size: 12px; margin-bottom: 16px;">Override load settings when running tests (leave empty to use test defaults)</p>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
            <div>
              <label style="font-size: 12px; color: var(--text-secondary); display: block; margin-bottom: 4px;">Virtual Users</label>
              <input type="number" id="loadVus" placeholder="e.g., 10" style="width: 100%; padding: 8px; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 6px; color: white; font-size: 14px;">
            </div>
            <div>
              <label style="font-size: 12px; color: var(--text-secondary); display: block; margin-bottom: 4px;">Iterations</label>
              <input type="number" id="loadIterations" placeholder="e.g., 5" style="width: 100%; padding: 8px; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 6px; color: white; font-size: 14px;">
            </div>
            <div>
              <label style="font-size: 12px; color: var(--text-secondary); display: block; margin-bottom: 4px;">Duration</label>
              <input type="text" id="loadDuration" placeholder="e.g., 30s, 1m" style="width: 100%; padding: 8px; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 6px; color: white; font-size: 14px;">
            </div>
            <div>
              <label style="font-size: 12px; color: var(--text-secondary); display: block; margin-bottom: 4px;">Ramp-up</label>
              <input type="text" id="loadRampUp" placeholder="e.g., 10s" style="width: 100%; padding: 8px; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 6px; color: white; font-size: 14px;">
            </div>
          </div>
          <div style="margin-top: 16px;">
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
              <input type="checkbox" id="headlessMode" style="width: 16px; height: 16px; cursor: pointer;">
              <span style="font-size: 14px;">Headless Mode</span>
              <span style="color: var(--text-secondary); font-size: 12px;">(web tests only)</span>
            </label>
          </div>
          <div id="workersSection" style="margin-top: 12px; display: none;">
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
              <input type="checkbox" id="useWorkers" style="width: 16px; height: 16px; cursor: pointer;">
              <span style="font-size: 14px;">Use Distributed Workers</span>
              <span id="workersInfo" style="color: var(--text-secondary); font-size: 12px;"></span>
            </label>
          </div>
          <p style="color: var(--text-secondary); font-size: 11px; margin-top: 12px;">Note: Duration overrides iterations. Leave both empty for test default.</p>
        </div>
        <div class="card">
          <h3>Test Console</h3>
          <div id="testRunStatus" style="margin-bottom: 16px;"></div>
          <div class="console-output" id="testConsole">Ready to run tests...</div>
        </div>
      </div>
    </div>

    <!-- Live Tests Panel -->
    <div id="live" class="panel">
      <div id="liveTestsContainer"></div>
    </div>

    <!-- Infrastructure Panel -->
    <div id="infra" class="panel">
      <div id="infraContainer"></div>
    </div>

    <!-- Results Panel -->
    <div id="results" class="panel">
      <div id="resultsContainer"></div>
    </div>

    <!-- Compare Panel -->
    <div id="compare" class="panel">
      <div class="card">
        <h3>Select Tests to Compare</h3>
        <div id="compareSelectContainer"></div>
        <button class="btn btn-primary" id="compareBtn" disabled style="margin-top: 16px;">Compare Selected</button>
      </div>
      <div id="comparisonResults"></div>
    </div>

    <!-- Detail Panel -->
    <div id="detail" class="panel">
      <button class="btn btn-secondary back-btn" onclick="showPanel('results')">&#8592; Back to Results</button>
      <div id="detailContent"></div>
    </div>
  </div>

  <script src="/scripts/main.js"></script>
</body>
</html>
